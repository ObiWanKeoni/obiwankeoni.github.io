<div>
  <button class="toggle-theme">
    <i class="lni lni-night"></i>
  </button>
</div>


<script>
function setTheme(theme) {
  const toggleDarkMode = document.querySelector('.toggle-theme');
  jtd.setTheme(theme);
  switch(theme) {
    case 'catppuccin-light':
      toggleDarkMode.innerHTML = '<i class="lni lni-sun"></i>';
      break;
    case 'catppuccin':
      toggleDarkMode.innerHTML = '<i class="lni lni-night"></i>';
      break;
    default:
      toggleDarkMode.innerHTML = '<i class="lni lni-sun"></i>';
      break;
  }
  hljs.highlightAll();
}

prefers_dark_theme = window.matchMedia('(prefers-color-scheme: dark)');
prefers_dark_theme.addEventListener('change', event => {
  const newColorScheme = event.matches ? "catppuccin" : "catppuccin-light";
  setTheme(newColorScheme);
});
const newColorScheme = prefers_dark_theme.matches ? "catppuccin" : "catppuccin-light";
setTheme(newColorScheme);

jtd.addEvent(document.querySelector('.toggle-theme'), 'click', function(){
  if (jtd.getTheme() === 'catppuccin') {
    setTheme('catppuccin-light')
  } else {
    setTheme('catppuccin');
  }
});

// use a class selector if available
let blocks = document.querySelectorAll("pre");

blocks.forEach((block) => {
  let code = block.querySelector("code");
  const language = code.result.language;
  block.insertAdjacentHTML("beforebegin",`<label>${language}</label>`)
  
  
  // only add button if browser supports Clipboard API
  if (navigator.clipboard) {
    let button = document.createElement("button");
    button.classList.add("btn")

    button.innerHtml = '<i class="lni lni-clipboard"></i>';
    block.appendChild(button);

    button.addEventListener("click", async () => {
      await copyCode(block, button);
    });
  }
});

async function copyCode(block, button) {
  let code = block.querySelector("code");
  let text = code.innerText;

  await navigator.clipboard.writeText(text);

  // visual feedback that task is completed
  button.innerHtml = "<p>Copied!</p>";

  setTimeout(() => {
    button.innerHtml = '<i class="lni lni-clipboard"></i>';
  }, 700);
}
</script>
